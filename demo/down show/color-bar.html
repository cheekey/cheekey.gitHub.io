<!DOCTYPE html>
<html>
<head>
  <title></title>
  <style type="text/css">
  #content{
    margin: 0 auto;
    width: 800px;
    position: relative;
  }
  .bar{
    position: absolute;
    opacity: 0;
    margin: 20px;
    width: 30px;
  }
  .show{
    opacity: 1;
    transition:1.3s; 
  }
  </style>
</head>
<body>
    <div id="content"></div>

    <script type="text/javascript">
      void function(){
        var content = document.getElementById('content');
        var width = 80;//每个块的宽度加上边距
        var i;
        var k = 27;//开始出现的数量
        var row = 10;//每排数量
        var s=[37,45,63];
        var top = [200,400,600];
        var bar = function(i){

          this.create(i);
        };
        
        bar.prototype.create = function(i){
          var long = function(){
            var l = Math.random();
            l = l<0.4?(l+0.5)*300:l*300;
            return l;
          };

          var color = function(){    
            return (function(m,s,c){    
              return (c ? arguments.callee(m,s,c-1) : '#') +    
                s[m.floor(m.random() * 16)]    
            })(Math,'0123456789abcdef',5)    
          }; 

          var div = document.createElement('div');
          div.style.left = width*i+'px';
          div.className = 'bar';
          div.style.height = long()+'px';
          div.style.backgroundColor = color();
          div.className = 'bar show';
          content.appendChild(div);
          var bar = document.getElementsByClassName('bar');
          var o = parseInt(bar.length/row);
            ss(o);
          
          function ss( p ){
            if( bar.length>row ){

              var a = document.getElementsByClassName('bar')[(i>row?i-row:i)].offsetHeight+40;
              var c = document.getElementsByClassName('bar')[(i>row?i-row:i)].offsetTop;
            }
            bar[i].style.left = width*(i-(row*p))+'px';
            bar[i].style.top = (a+c)+'px';
          }
        };

        bar.prototype.remove = function(){
          
        };

        for( i = 0; i < k; i ++ ){
          new bar(i);
        }
        
        window.addEventListener('scroll',function(){
          
          var heihgt = document.getElementsByClassName('bar');
          for( var q = 0, l = top.length; q < l; q ++ ){
            if( document.body.scrollTop>top[q]&&document.body.scrollTop<top[q+1] ){
              
                for( var ic = 0, l = s.length; ic < l; ic ++ ){
                  
                  if( s[ic]>heihgt.length ){

                    for(var ww ;s[ic] >= i; i ++ ){
               
                        new bar( i );
                    }
                  }

                }
              
            }
          }
        },false)
      }();
    </script>
</body>
</html>